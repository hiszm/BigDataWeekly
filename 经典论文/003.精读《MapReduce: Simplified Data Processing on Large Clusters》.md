
![](https://github.com/user-attachments/assets/8df7ec2e-0206-4b64-b4b5-b96425950bf4)


@[toc]
## 1. å¼•è¨€ï¼š

åœ¨æœ¬æœŸçš„ç²¾è¯»ä¼šä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸€ç¯‡å…·æœ‰é‡Œç¨‹ç¢‘æ„ä¹‰çš„è®ºæ–‡â€”â€”ã€ŠMapReduce: Simplified Data Processing on Large Clustersã€‹ã€‚è¿™ç¯‡è®ºæ–‡ä¸ä»…å¥ å®šäº†å¤§æ•°æ®æ—¶ä»£åˆ†å¸ƒå¼å¤„ç†çš„åŸºçŸ³ï¼Œæ›´ä»¥å…¶åˆ›æ–°çš„æ•°æ®å¤„ç†æ¨¡å¼ï¼Œæˆä¸ºå¤§æ•°æ®å¤„ç†æ¶æ„çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ã€‚MapReduceçš„è®¾è®¡å“²å­¦å’Œå®ç°æœºåˆ¶ï¼Œå¯¹äºæ­ç¤ºç°ä»£å¤§è§„æ¨¡æ•°æ®å¤„ç†çš„å†…åœ¨é€»è¾‘å…·æœ‰ä¸å¯ä¼°é‡çš„ä»·å€¼ã€‚


æœ¬æ–‡å°†å¼•å¯¼è¯»è€…ï¼š

- æ¢è®¨MapReduceåœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸­çš„åº”ç”¨åœºæ™¯ã€‚
- æ·±å…¥å‰–æMapReduceçš„æ ¸å¿ƒæ¶æ„å’ŒåŸºæœ¬åŸåˆ™ã€‚
- è§£æMapReduceåœ¨æ•°æ®å®¹é”™æ–¹é¢çš„æŒ‘æˆ˜ã€‚
- å±•æœ›MapReduceåœ¨æœªæ¥æŠ€æœ¯å‘å±•ä¸­çš„æ½œåœ¨æ¼”å˜å’Œåº”ç”¨ã€‚

æ— è®ºæ‚¨æ˜¯å¤§æ•°æ®é¢†åŸŸçš„èµ„æ·±ä¸“å®¶ï¼Œè¿˜æ˜¯åˆšåˆšè¿ˆå…¥æ•°æ®ç§‘å­¦é¢†åŸŸçš„æ–°å…µï¼Œæˆ‘ä»¬éƒ½å°†ä¸€åŒè¸ä¸Šè¿™æ®µæ¢ç´¢ä¹‹æ—…ï¼Œæ·±å…¥æŒ–æ˜`MapReduce`çš„æ·±å±‚æ¬¡é­…åŠ›å’Œå®ç”¨ä»·å€¼ã€‚


## 2. ç²¾è¯»
### 2.1 èƒŒæ™¯

> Users specify a **map function** that processes a key/value pair to generate a set of intermediate key/value pairs, and a **reduce function** that merges all intermediate values associated with the same intermediate key.

é¦–å…ˆï¼Œä»‹ç»äº†`MapReduce`æ˜¯ä¸€ç§ç¼–ç¨‹æ¨¡å‹åŠå…¶é…å¥—çš„å®ç°æ¡†æ¶ï¼Œä¸“é—¨è®¾è®¡ç”¨äºå¤„ç†å’Œç”Ÿæˆå¤§è§„æ¨¡æ•°æ®é›†ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œç”¨æˆ·å®šä¹‰ä¸¤ä¸ªå…³é”®å‡½æ•°ï¼š`map`å‡½æ•°å’Œ`reduce`å‡½æ•°ã€‚`Map`å‡½æ•°è´Ÿè´£å¤„ç†è¾“å…¥çš„é”®/å€¼å¯¹ï¼Œå¹¶é€šè¿‡ä¸€å®šçš„é€»è¾‘è½¬æ¢ç”Ÿæˆä¸€ç»„ä¸­é—´é”®/å€¼å¯¹ã€‚éšåï¼Œ`reduce`å‡½æ•°çš„ä½œç”¨æ˜¯å°†æ‰€æœ‰å…·æœ‰ç›¸åŒä¸­é—´é”®çš„å€¼åˆå¹¶èµ·æ¥ï¼Œä»è€Œå®ç°æ•°æ®çš„æ±‡æ€»å’Œå½’çº³ã€‚


> Hundreds of MapReduce programs have been implemented, and upwards of one thousand MapReduce jobs are executed on Googleâ€™s clusters every day.


ç„¶åï¼Œè¯´äº†ä¸€ä¸‹å·²ç»æŠ•å…¥çš„ä½¿ç”¨æƒ…å†µï¼Œå¼ºè°ƒMapReduceåœ¨Googleå†…éƒ¨çš„å¹¿æ³›åº”ç”¨å’Œé«˜æ•ˆæ€§ã€‚å…·ä½“æ¥è¯´ï¼š

- åº”ç”¨å¹¿æ³›ï¼šå·²ç»å®ç°äº†æ•°ç™¾ä¸ª`MapReduce`ç¨‹åºï¼Œè¯´æ˜è¯¥æ¨¡å‹è¢«å¹¿æ³›ç”¨äºå„ç§ä»»åŠ¡ã€‚
- è§„æ¨¡å®å¤§ï¼šæ¯å¤©åœ¨`Google`é›†ç¾¤ä¸Šæ‰§è¡Œè¶…è¿‡ä¸€åƒä¸ªMapReduceä½œä¸šï¼Œæ˜¾ç¤ºå‡ºå…¶åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æ—¶çš„æ•ˆç‡å’Œå¯é æ€§ã€‚

> The issues of how to parallelize the computation, distribute the data, and handle failures conspire to obscure the original simple computation with large amounts of complex code to deal with these issues.

æ¥ç€ï¼ŒæŒ‡å‡ºï¼Œå°½ç®¡è®¡ç®—æœ¬èº«å¯èƒ½å¾ˆç®€å•ï¼Œä½†åœ¨å¹¶è¡ŒåŒ–è®¡ç®—ã€åˆ†å‘æ•°æ®å’Œå¤„ç†æ•…éšœæ—¶ï¼Œä¼šäº§ç”Ÿå¤§é‡å¤æ‚çš„ä»£ç ï¼Œä»è€Œä½¿å¾—åŸæœ¬ç®€å•çš„è®¡ç®—å˜å¾—å¤æ‚ã€‚è¿™å¼ºè°ƒäº†åœ¨å¤§è§„æ¨¡æ•°æ®å¤„ç†ä¸­ï¼ŒåŸºç¡€è®¾æ–½ç®¡ç†å’Œä»£ç å¤æ‚æ€§æ˜¯ä¸»è¦æŒ‘æˆ˜ã€‚è¿™ä¹Ÿæ˜¯æœ¬æ–‡éœ€è¦è§£å†³çš„é—®é¢˜ã€‚


> We realized that most of our computations involved applying a **map operation** to each logical "record" in our input to compute a set of intermediate key/value pairs, and then applying a **reduce operation** to all the values that shared the same key, in order to combine the derived data appropriately.

éšåï¼Œä»–ä»¬å‘ç°å¤§å¤šæ•°è®¡ç®—ä»»åŠ¡å¯ä»¥é€šè¿‡ä¸¤ä¸ªæ­¥éª¤æ¥å®Œæˆï¼šé¦–å…ˆï¼Œå¯¹æ¯ä¸ªè¾“å…¥è®°å½•åº”ç”¨ä¸€ä¸ª`map`æ“ä½œï¼Œç”Ÿæˆä¸€ç»„ä¸­é—´é”®å€¼å¯¹ï¼›ç„¶åï¼Œå¯¹æ‰€æœ‰å…·æœ‰ç›¸åŒé”®çš„å€¼åº”ç”¨`reduce`æ“ä½œï¼Œä»¥é€‚å½“çš„æ–¹å¼åˆå¹¶æ´¾ç”Ÿçš„æ•°æ®ã€‚è¿™æè¿°äº†`MapReduce`æ¨¡å‹çš„æ ¸å¿ƒæµç¨‹ï¼Œç®€åŒ–äº†å¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡ã€‚


> The major contributions of this work are a **simple and powerful interface** that enables automatic parallelization and distribution of large-scale computations, combined with an implementation of this interface that achieves high performance on large clusters of commodity PCs.

æœ€åï¼Œç‚¹å‡ºæœ¬æ–‡å·¥ä½œçš„ä¸»è¦è´¡çŒ®åœ¨äºæä¾›äº†ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„æ¥å£ï¼Œè¯¥æ¥å£èƒ½è‡ªåŠ¨å®ç°å¤§è§„æ¨¡è®¡ç®—çš„å¹¶è¡ŒåŒ–å’Œåˆ†å¸ƒå¼å¤„ç†ã€‚åŒæ—¶ï¼Œè¿™ä¸ªæ¥å£çš„å®ç°èƒ½å¤Ÿåœ¨ç”±æ™®é€šPCç»„æˆçš„å¤§å‹é›†ç¾¤ä¸Šè¾¾åˆ°é«˜æ€§èƒ½ã€‚è¿™å¼ºè°ƒäº†MapReduceæ¨¡å‹çš„ç®€æ´æ€§ã€æ˜“ç”¨æ€§å’Œé«˜æ•ˆæ€§ã€‚



> **Section 2** describes the basic programming model and gives several examples.  
> **Section 3** describes an implementation of the MapReduce interface tailored towards our cluster-based computing environment.  
> **Section 4** describes several refinements of the programming model that we have found useful.  
> **Section 5** presents performance measurements of our implementation for a variety of tasks.  
> **Section 6** explores the use of MapReduce within Google, including our experiences in using it as the basis for a rewrite of our
> production indexing system.  
> **Section 7** discusses related and future work.

ä»¥åŠä»‹ç»äº†æœ¬æ–‡çš„è®ºæ–‡ç»“æ„ï¼Œæœ¬æ–‡é‡ç‚¹æ¢è®¨ç¬¬äºŒã€ä¸‰ç« 
- **ç¬¬2èŠ‚**ï¼šä»‹ç»äº†åŸºæœ¬çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¹¶ç»™å‡ºäº†å‡ ä¸ªç¤ºä¾‹ã€‚
- **ç¬¬3èŠ‚**ï¼šæè¿°äº†é’ˆå¯¹é›†ç¾¤è®¡ç®—ç¯å¢ƒçš„MapReduceæ¥å£å®ç°ã€‚
- **ç¬¬4èŠ‚**ï¼šä»‹ç»äº†åœ¨ç¼–ç¨‹æ¨¡å‹ä¸­çš„ä¸€äº›æœ‰ç”¨æ”¹è¿›ã€‚
- **ç¬¬5èŠ‚**ï¼šå±•ç¤ºäº†æˆ‘ä»¬å®ç°çš„å„ç§ä»»åŠ¡çš„æ€§èƒ½æµ‹é‡ã€‚
- **ç¬¬6èŠ‚**ï¼šæ¢è®¨äº†MapReduceåœ¨Googleå†…éƒ¨çš„ä½¿ç”¨ï¼ŒåŒ…æ‹¬å°†å…¶ç”¨äºæ”¹å†™ç”Ÿäº§ç´¢å¼•ç³»ç»Ÿçš„ç»éªŒã€‚
- **ç¬¬7èŠ‚**ï¼šè®¨è®ºäº†ç›¸å…³å·¥ä½œå’Œæœªæ¥çš„å‘å±•æ–¹å‘ã€‚


### 2.2 æ¨¡å‹åº”ç”¨

åœ¨MapReduceæ¡†æ¶ä¸­ï¼Œè®¡ç®—è¿‡ç¨‹ä»ä¸€ç»„è¾“å…¥é”®/å€¼å¯¹å¼€å§‹ï¼Œå¹¶æœ€ç»ˆäº§ç”Ÿä¸€ç»„è¾“å‡ºé”®/å€¼å¯¹ã€‚è¿™ä¸€è¿‡ç¨‹ç”±ç”¨æˆ·é€šè¿‡å®šä¹‰ä¸¤ä¸ªå…³é”®å‡½æ•°æ¥å®ç°ï¼š**Map**å’Œ**Reduce**ã€‚

**Mapå‡½æ•°**ç”±ç”¨æˆ·ç¼–å†™ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªè¾“å…¥é”®/å€¼å¯¹ï¼Œå¹¶è´Ÿè´£ç”Ÿæˆä¸€ç»„ä¸­é—´é”®/å€¼å¯¹ã€‚MapReduceåº“éšåè´Ÿè´£å°†æ‰€æœ‰å…·æœ‰ç›¸åŒä¸­é—´é”®çš„ä¸­é—´å€¼èšé›†åœ¨ä¸€èµ·ï¼Œä¸ºä¸‹ä¸€æ­¥å¤„ç†åšå¥½å‡†å¤‡ã€‚

**Reduceå‡½æ•°**åŒæ ·ç”±ç”¨æˆ·å®šä¹‰ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªä¸­é—´é”®ä»¥åŠä¸è¯¥é”®ç›¸å…³è”çš„æ‰€æœ‰ä¸­é—´å€¼ã€‚Reduceå‡½æ•°çš„èŒè´£æ˜¯å°†è¿™äº›å€¼è¿›è¡Œåˆå¹¶å¤„ç†ï¼Œé€šå¸¸ä¼šäº§ç”Ÿä¸€ç»„æ•°é‡æ›´å°‘çš„è¾“å‡ºå€¼ã€‚åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯æ¬¡Reduceå‡½æ•°è°ƒç”¨ä»…ç”Ÿæˆé›¶ä¸ªæˆ–ä¸€ä¸ªè¾“å‡ºå€¼ã€‚ä¸­é—´å€¼é€šè¿‡è¿­ä»£å™¨çš„å½¢å¼æä¾›ç»™ç”¨æˆ·çš„Reduceå‡½æ•°ï¼Œè¿™ç§è®¾è®¡å…è®¸MapReduceæ¡†æ¶å¤„ç†é‚£äº›å¤ªå¤§è€Œæ— æ³•ä¸€æ¬¡æ€§è½½å…¥å†…å­˜çš„å€¼åˆ—è¡¨ã€‚

é€šè¿‡è¿™ç§åˆ†é˜¶æ®µçš„å¤„ç†æ¨¡å¼ï¼ŒMapReduceåº“èƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†ï¼ŒåŒæ—¶ä¿æŒäº†ç”¨æˆ·ä»£ç çš„ç®€æ´æ€§å’Œæ˜“äºç®¡ç†ã€‚


```java
// Mapå‡½æ•°å¤„ç†è¾“å…¥çš„æ–‡æ¡£ï¼Œå°†æ¯ä¸ªå•è¯æ˜ å°„ä¸ºä¸€ä¸ªé”®/å€¼å¯¹ï¼Œå…¶ä¸­å€¼æ˜¯â€œ1â€ã€‚
map(String key, String value) {
  // key: æ–‡æ¡£åç§°
  // value: æ–‡æ¡£å†…å®¹
  for each word w in value:
    // ä¸ºæ¯ä¸ªå•è¯wå‘å°„ä¸€ä¸ªä¸­é—´é”®/å€¼å¯¹ï¼Œé”®æ˜¯å•è¯æœ¬èº«ï¼Œå€¼æ˜¯å­—ç¬¦ä¸²"1"ã€‚
    EmitIntermediate(w, "1");
}

// Reduceå‡½æ•°æ¥æ”¶ä¸€ä¸ªå•è¯å’Œè¯¥å•è¯æ‰€æœ‰å‡ºç°æ¬¡æ•°çš„è¿­ä»£å™¨ï¼Œ
// ç„¶ååˆå¹¶è¿™äº›æ¬¡æ•°ä»¥äº§ç”Ÿæœ€ç»ˆçš„å•è¯è®¡æ•°ã€‚
reduce(String key, Iterator values) {
  // key: ä¸€ä¸ªå•è¯
  // values: è¯¥å•è¯å‡ºç°æ¬¡æ•°çš„åˆ—è¡¨
  int result = 0;
  for each v in values:
    // å°†å­—ç¬¦ä¸²å€¼è§£æä¸ºæ•´æ•°å¹¶ç´¯åŠ åˆ°ç»“æœä¸­
    result += ParseInt(v);
  // ç”Ÿæˆæœ€ç»ˆçš„å•è¯è®¡æ•°
  Emit(AsString(result));
}
```

```java
map(k1,v1) -> list(k2,v2)
reduce(k2,list(v2)) -> list(v2)
```

è¿˜æœ‰å…¶ä»–çš„ä¸€äº›åº”ç”¨åœºæ™¯å¦‚ä¸‹æ‰€ç¤ºï¼š

**1. åˆ†å¸ƒå¼å­—ç¬¦ä¸²åŒ¹é… `grep`**

`map` å‡½æ•°è´Ÿè´£è¾“å‡ºåŒ¹é…æŸä¸ªæ¨¡å¼çš„æ¯ä¸€è¡Œï¼Œè€Œ `reduce` å‡½æ•°åˆ™ä¸è¿›è¡Œä»»ä½•è®¡ç®—ï¼Œä»…å°†è¿™ä¸€è¡Œè¾“å‡ºã€‚æœ€ç»ˆï¼Œå¾—åˆ°çš„ç»“æœæ˜¯æ‰€æœ‰åŒ¹é…çš„æ–‡æœ¬è¡Œã€‚

**2. è®¡ç®— URL çš„è®¿é—®é¢‘ç‡**

`map` å‡½æ•°è®°å½•æ¯ä¸ªè¯·æ±‚ï¼Œè¾“å‡ºå½¢å¼ä¸º `(url, 1)`ï¼›è€Œ `reduce` å‡½æ•°åˆ™å°†ç›¸åŒ URL çš„è®¿é—®è®¡æ•°ç›¸åŠ ï¼Œæœ€ç»ˆç”Ÿæˆ `(url, sum_of_count)`ã€‚

**3. å€’è½¬ç½‘ç»œé“¾æ¥å…³ç³»**

æœç´¢å¼•æ“æ’åºç®—æ³• `PageRank` éœ€è¦ä½¿ç”¨çˆ¬è™«è·å–æ‰€æœ‰é¡µé¢çš„ `source` åŠå…¶å†…éƒ¨é“¾æ¥ `target`ã€‚æ¯ä¸ª `source` å†…å¯èƒ½ä¼šæœ‰å¤šä¸ª `target`ï¼Œåœ¨é—¨æˆ·ç½‘ç«™ä¸­ï¼Œä¸€ä¸ª `source` æ‹¥æœ‰ä¸Šåƒä¸ª `target` æ˜¯å¾ˆå¸¸è§çš„ã€‚

è¿™å°±è¦æ±‚ç½‘ç»œçˆ¬è™«ç»Ÿè®¡æ¯ä¸ªé“¾æ¥ `target` è¢«å“ªäº› `source` å¼•ç”¨ã€‚æœ€åˆï¼Œæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ `(source, target)` æ•°æ®å¯¹ï¼Œå¦‚ä½•å°†å…¶è½¬æ¢ä¸º `(target, list(source))` å‘¢ï¼Ÿè¿™æ—¶ï¼Œ`MapReduce` çš„ä½œç”¨ä¾¿å‡¸æ˜¾å‡ºæ¥ã€‚

`map` å‡½æ•°è´Ÿè´£è¾“å‡º `(source, target)` å¯¹ï¼Œè€Œ `reduce` å‡½æ•°åˆ™å°†ç›¸åŒçš„ `target` è¿›è¡Œå½’å¹¶ï¼Œç”Ÿæˆ `(target, list(source))`ã€‚

**4. ç¡®å®šæ¯ä¸ª Host çš„æ£€ç´¢è¯å‘é‡ï¼ˆTerm-Vectorï¼‰**

æ£€ç´¢è¯å‘é‡æ˜¯ä¸€ç³»åˆ—ï¼ˆå•è¯ï¼Œè¯é¢‘ï¼‰å¯¹ï¼Œè¿™äº›æ•°æ®èƒ½å¤Ÿæ€»ç»“ä¸€ç¯‡æ–‡æ¡£æˆ–ä¸€ç³»åˆ—æ–‡ç« ä¸­æœ€é‡è¦çš„å•è¯ï¼ˆå‡è®¾è¯é¢‘è¶Šé«˜ï¼Œå•è¯è¶Šé‡è¦ï¼‰ã€‚

ä¸€ä¸ª Host å¯èƒ½åŒ…å«å¤§é‡æ–‡æ¡£ï¼Œå¦‚ä½•ç¡®å®šè¯¥ Host çš„æ£€ç´¢è¯å‘é‡å‘¢ï¼Ÿ

`map` å‡½æ•°è´Ÿè´£è¾“å‡ºæ¯ä¸ªè¾“å…¥æ–‡æ¡£çš„ `(host, term-vector)`ï¼Œè€Œ `reduce` å‡½æ•°åˆ™æ±‡æ€»ç»™å®š Host çš„æ‰€æœ‰ term-vectorï¼Œè¿‡æ»¤æ‰ä½é¢‘è¯ï¼Œæœ€ç»ˆè¾“å‡ºå”¯ä¸€çš„ `(host, term-vector)`ã€‚

**5. å€’æ’ç´¢å¼•**

æ­£æ’ç´¢å¼•çš„å½¢å¼ä¸º `(document, {keys})`ï¼Œä»æ–‡æ¡£å‡ºå‘ä»¥æ£€ç´¢å…³é”®è¯ã€‚

ç„¶è€Œï¼Œæ­£æ’ç´¢å¼•åœ¨æœç´¢å¼•æ“ä¸­çš„ä½œç”¨æœ‰é™ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æ ¹æ®å…³é”®è¯æ£€ç´¢å¯¹åº”çš„æ‰€æœ‰æ–‡æ¡£ã€‚å› æ­¤ï¼Œæ›´éœ€è¦çš„æ˜¯ `(key, {documents})` è¿™ç§ç´¢å¼•å½¢å¼ã€‚

å€’æ’ç´¢å¼•æ˜¯å…³é”®è¯åˆ°æ–‡æ¡£çš„æ˜ å°„ï¼Œæ¯ä¸ªå…³é”®è¯éƒ½å¯¹åº”ç€ä¸€ç³»åˆ—æ–‡æ¡£ã€‚

`map` å‡½æ•°åˆ†ææ¯ä¸ªæ–‡æ¡£ï¼Œä¸ºæ¯ä¸ªå•è¯ç”Ÿæˆ `(word, document)` çš„æ˜ å°„ï¼›è€Œ `reduce` å‡½æ•°åˆ™æ±‡æ€»æ‰€æœ‰ç›¸åŒå•è¯çš„æ•°æ®å¯¹ï¼Œè¾“å‡ºå½¢å¼ä¸º `(word, {documents})`ï¼Œå¹¶å¯èƒ½è¿›è¡Œæ’åºã€‚

### 2.3 åŸºæœ¬åŸç†

![image](https://github.com/user-attachments/assets/e291eba7-2db9-4b5b-8f85-0fdc247494b2)

MapReduceæ¡†æ¶çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥æ¦‚è¿°ä¸ºä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š

1. **è¾“å…¥åˆ†å‰²**ï¼š**ç”¨æˆ·ç¨‹åº**ä¸­çš„`MapReduce`åº“é¦–å…ˆå°†è¾“å…¥æ–‡ä»¶åˆ†å‰²æˆMä¸ªç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µé€šå¸¸å¤§å°åœ¨**16MBåˆ°64MB**ä¹‹é—´ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¯é€‰å‚æ•°æ§åˆ¶ã€‚

2. **å¯åŠ¨ä½œä¸š**ï¼šç¨‹åºåœ¨é›†ç¾¤çš„å¤šå°æœºå™¨ä¸Šå¯åŠ¨å¤šä¸ªå‰¯æœ¬ï¼Œå…¶ä¸­ä¸€ä¸ªæœºå™¨ä½œä¸º`master`ï¼Œå…¶ä½™ä½œä¸º`worker`ã€‚

3. **ä»»åŠ¡åˆ†é…**ï¼š`master`è´Ÿè´£åˆ†é…Mä¸ª`map`ä»»åŠ¡å’ŒRä¸ª`reduce`ä»»åŠ¡ç»™ç©ºé—²çš„`worker`ã€‚

4. **Mapä»»åŠ¡æ‰§è¡Œ**ï¼šè¢«åˆ†é…`map`ä»»åŠ¡çš„`worker`è¯»å–ç›¸åº”è¾“å…¥ç‰‡æ®µçš„å†…å®¹ï¼Œè§£æå‡ºé”®/å€¼å¯¹ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„`Map`å‡½æ•°ã€‚`Map`å‡½æ•°ç”Ÿæˆçš„ä¸­é—´é”®/å€¼å¯¹åœ¨å†…å­˜ä¸­ç¼“å†²ã€‚

5. **ä¸­é—´æ•°æ®å†™å…¥**ï¼šç¼“å†²çš„ä¸­é—´æ•°æ®å®šæœŸå†™å…¥æœ¬åœ°ç£ç›˜ï¼Œå¹¶æ ¹æ®åˆ†åŒºå‡½æ•°åˆ’åˆ†ä¸ºRä¸ªåŒºåŸŸã€‚è¿™äº›ç¼“å†²æ•°æ®åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ä½ç½®ä¿¡æ¯è¢«å‘é€å›`master`ã€‚

6. **Reduceä»»åŠ¡æ‰§è¡Œ**ï¼š`master`é€šçŸ¥`reduce worker`è¿™äº›ä½ç½®ä¿¡æ¯ï¼Œ`reduce worker`ä½¿ç”¨è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ä»`map worker`çš„æœ¬åœ°ç£ç›˜è¯»å–ç¼“å†²æ•°æ®ã€‚è¯»å–å®Œæ‰€æœ‰ä¸­é—´æ•°æ®åï¼Œ`reduce worker`æŒ‰ä¸­é—´é”®æ’åºï¼Œå¹¶å°†æ¯ä¸ªå”¯ä¸€çš„ä¸­é—´é”®åŠå…¶å¯¹åº”çš„å€¼é›†åˆä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„`Reduce`å‡½æ•°ã€‚

7. **è¾“å‡ºç»“æœ**ï¼š`Reduce`å‡½æ•°çš„è¾“å‡ºè¢«è¿½åŠ åˆ°æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ä¸­ï¼Œæ¯ä¸ª`reduce`ä»»åŠ¡å¯¹åº”ä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ã€‚

8. **ä½œä¸šå®Œæˆ**ï¼šæ‰€æœ‰`map`å’Œ`reduce`ä»»åŠ¡å®Œæˆåï¼Œ`master`å”¤é†’ç”¨æˆ·ç¨‹åºï¼Œ`MapReduce`è°ƒç”¨åœ¨ç”¨æˆ·ç¨‹åºä¸­è¿”å›ã€‚


`MapReduce`çš„å·¥ä½œæµç¨‹å°±åƒæ˜¯åœ¨å¨æˆ¿é‡Œå‡†å¤‡ä¸€åœºå¤§å‹å®´ä¼šï¼šé¦–å…ˆï¼Œå¤§å¨ï¼ˆ`Master`èŠ‚ç‚¹ï¼‰å°†å¤§é‡çš„é£Ÿæï¼ˆæ•°æ®ï¼‰åˆ‡æˆå°å—ï¼ˆåˆ†å‰²æ•°æ®ï¼‰ï¼Œç„¶ååˆ†é…ç»™ä¸€ç¾¤å¨å¸ˆï¼ˆ`Worker`èŠ‚ç‚¹ï¼‰å»å¤„ç†ã€‚æ¯ä¸ªå¨å¸ˆæ ¹æ®é£Ÿè°±ï¼ˆ`Map`å‡½æ•°ï¼‰è¿›è¡Œåˆæ­¥çƒ¹é¥ªï¼Œæ¯”å¦‚ç»Ÿè®¡æ¯ç§é£Ÿæçš„ä½¿ç”¨é‡ã€‚æ¥ç€ï¼Œä»–ä»¬å°†å¤„ç†å¥½çš„é£Ÿææš‚æ—¶å­˜æ”¾èµ·æ¥ã€‚éšåï¼Œå¤§å¨å°†ç›¸åŒç±»å‹çš„åŠæˆå“æ”¶é›†èµ·æ¥ï¼Œäº¤ç»™å¦ä¸€ç»„å¨å¸ˆè¿›è¡Œæœ€ç»ˆçƒ¹é¥ªï¼ˆ`Reduce`å‡½æ•°ï¼‰ï¼Œæ¯”å¦‚å°†æ‰€æœ‰ç›¸åŒçš„é£Ÿæåˆå¹¶æˆä¸€é“èœã€‚æœ€åï¼Œå½“æ‰€æœ‰èœè‚´éƒ½å‡†å¤‡å¥½åï¼Œå¤§å¨å°†å®ƒä»¬ç«¯ä¸Šæ¡Œï¼Œä¾›å®¾å®¢äº«ç”¨ï¼ˆè¾“å‡ºç»“æœï¼‰ã€‚å¦‚æœæŸä¸ªå¨å¸ˆæ— æ³•å®Œæˆä»»åŠ¡ï¼Œå¤§å¨ä¼šè¿…é€Ÿæ‰¾å…¶ä»–å¨å¸ˆæ¥æ›¿è¡¥ï¼Œç¡®ä¿å®´ä¼šèƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œã€‚æ•´ä¸ªè¿‡ç¨‹æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½ç´§å¯†åè°ƒï¼Œä»¥ç¡®ä¿æœ€ç»ˆçš„èœè‚´æ—¢ç¾å‘³åˆåŠæ—¶ã€‚



`Hadoop MapReduce`çš„æ‰§è¡Œæµç¨‹ä¸`Google MapReduce`æœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œå› ä¸º`Hadoop`çš„è®¾è®¡å—åˆ°äº†`Google MapReduce`è®ºæ–‡çš„å¯å‘ã€‚ä»¥ä¸‹æ˜¯`Hadoop MapReduce`æ‰§è¡Œæµç¨‹çš„æ¦‚è¿°å›¾ã€‚






![image](https://github.com/user-attachments/assets/7b8f85f2-bc34-4334-bb9e-5896d878fc31)


åœ¨ Hadoop 3.x ç‰ˆæœ¬ä¸­ï¼ŒMapReduce ä½œä¸šçš„æ‰§è¡Œæµç¨‹åˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼š`Map` é˜¶æ®µå’Œ `Reduce` é˜¶æ®µã€‚ä»¥ä¸‹æ˜¯è¿™ä¸¤ä¸ªé˜¶æ®µçš„è¯¦ç»†æè¿°ï¼š

 **`Map` é˜¶æ®µï¼š**
1. **ä½œä¸šæäº¤**ï¼šç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯æäº¤ MapReduce ä½œä¸šï¼ŒåŒ…æ‹¬ `Map` å’Œ `Reduce` ä»»åŠ¡ã€‚
2. **èµ„æºç”³è¯·**ï¼š`ApplicationMaster` å‘ `ResourceManager` ç”³è¯·æ‰§è¡Œ `Map` ä»»åŠ¡æ‰€éœ€çš„èµ„æºã€‚
3. **ä»»åŠ¡åˆ†é…**ï¼š`ResourceManager` æ ¹æ®é›†ç¾¤èµ„æºæƒ…å†µï¼Œå°† `Map` ä»»åŠ¡åˆ†é…ç»™ `NodeManager` æ‰§è¡Œã€‚
4. **`Map` ä»»åŠ¡æ‰§è¡Œ**ï¼š`NodeManager` åœ¨åˆ†é…çš„å®¹å™¨ä¸­å¯åŠ¨ `Map` ä»»åŠ¡ï¼Œ`Map` ä»»åŠ¡è¯»å–è¾“å…¥æ•°æ®ï¼Œå¤„ç†åç”Ÿæˆä¸­é—´é”®/å€¼å¯¹ã€‚
5. **ä¸­é—´æ•°æ®è¾“å‡º**ï¼š`Map` ä»»åŠ¡å°†å¤„ç†ç»“æœè¾“å‡ºåˆ°æœ¬åœ°ç£ç›˜ï¼Œä¸ºåç»­çš„ Shuffle å’Œ Sort é˜¶æ®µåšå‡†å¤‡ã€‚

 **`Reduce` é˜¶æ®µï¼š**
1. **Shuffle é˜¶æ®µ**ï¼š`Map` ä»»åŠ¡çš„è¾“å‡ºè¢«ä¼ è¾“åˆ° `Reduce` ä»»åŠ¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º Shuffleï¼Œå®ƒåŒ…æ‹¬æ’åºå’Œåˆå¹¶ `Map` ä»»åŠ¡çš„è¾“å‡ºï¼Œä»¥ä¾¿ä¸º `Reduce` ä»»åŠ¡æä¾›æœ‰åºçš„è¾“å…¥ã€‚
2. **èµ„æºç”³è¯·**ï¼š`ApplicationMaster` å‘ `ResourceManager` ç”³è¯·æ‰§è¡Œ `Reduce` ä»»åŠ¡æ‰€éœ€çš„èµ„æºã€‚
3. **ä»»åŠ¡åˆ†é…**ï¼š`ResourceManager` å°† `Reduce` ä»»åŠ¡åˆ†é…ç»™ `NodeManager` æ‰§è¡Œã€‚
4. **`Reduce` ä»»åŠ¡æ‰§è¡Œ**ï¼š`NodeManager` åœ¨åˆ†é…çš„å®¹å™¨ä¸­å¯åŠ¨ `Reduce` ä»»åŠ¡ï¼Œ`Reduce` ä»»åŠ¡è¯»å–ç»è¿‡ Shuffle é˜¶æ®µæ’åºçš„ä¸­é—´æ•°æ®ï¼Œè¿›è¡Œæ±‡æ€»å’Œå¤„ç†ã€‚
5. **è¾“å‡ºç»“æœ**ï¼š`Reduce` ä»»åŠ¡å°†æœ€ç»ˆç»“æœå†™å…¥åˆ° HDFSï¼ˆHadoop Distributed File Systemï¼‰ä¸­ã€‚

åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œ`ApplicationMaster` è´Ÿè´£åè°ƒ `Map` å’Œ `Reduce` ä»»åŠ¡çš„æ‰§è¡Œï¼Œç›‘æ§ä»»åŠ¡è¿›åº¦ï¼Œå¹¶ä¸ `ResourceManager` å’Œ `NodeManager` è¿›è¡Œé€šä¿¡ã€‚æ­¤å¤–ï¼ŒHadoop 3.x å¼•å…¥äº†æ›´å¤šçš„ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œä¾‹å¦‚æ”¹è¿›çš„ Shuffle æœºåˆ¶ã€æ›´å¥½çš„èµ„æºéš”ç¦»å’Œæ›´é«˜æ•ˆçš„æ•°æ®æœ¬åœ°åŒ–ï¼Œä»¥æé«˜ MapReduce ä½œä¸šçš„æ€§èƒ½å’Œå¯é æ€§ã€‚


>`JobTracker` æ˜¯ Hadoop 1.x ç‰ˆæœ¬ä¸­çš„å…³é”®ç»„ä»¶ï¼Œå®ƒè´Ÿè´£ç®¡ç†å’Œè°ƒåº¦ MapReduce ä½œä¸šã€‚åœ¨ Hadoop 1.x ç‰ˆæœ¬ä¸­ï¼Œ`JobTracker` ä¸ `TaskTracker` é…åˆå·¥ä½œï¼Œå…¶ä¸­ `JobTracker` è´Ÿè´£ä½œä¸šçš„è°ƒåº¦å’Œç›‘æ§ï¼Œè€Œ `TaskTracker` åˆ™åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œå®é™…çš„ä»»åŠ¡ã€‚
éšç€ Hadoop ç”Ÿæ€ç³»ç»Ÿçš„å‘å±•ï¼Œä¸ºäº†è§£å†³ Hadoop 1.x ç‰ˆæœ¬ä¸­çš„å¯æ‰©å±•æ€§å’Œèµ„æºç®¡ç†é—®é¢˜ï¼ŒHadoop 2.x ç‰ˆæœ¬å¼•å…¥äº† YARNï¼ˆYet Another Resource Negotiatorï¼‰ä½œä¸ºé›†ç¾¤èµ„æºç®¡ç†å™¨ã€‚åœ¨ Hadoop 2.x ç‰ˆæœ¬ä¸­ï¼Œ`JobTracker` çš„èŒè´£è¢«æ‹†åˆ†ï¼Œå…¶ä¸­ä½œä¸šè°ƒåº¦å’Œç›‘æ§çš„èŒè´£ç”± `ResourceManager` ç»„ä»¶æ‰¿æ‹…ï¼Œè€Œä»»åŠ¡çš„æ‰§è¡Œåˆ™ç”± `NodeManager` ç»„ä»¶è´Ÿè´£ã€‚



```java
// è®¾ç½®Hadoopç”¨æˆ·åä¸º"hadoop"
System.setProperty("HADOOP_USER_NAME","hadoop");
// åˆ›å»ºHadoopé…ç½®å¯¹è±¡
Configuration configuration= new Configuration();
// è®¾ç½®é»˜è®¤çš„æ–‡ä»¶ç³»ç»Ÿä¸ºHDFSï¼Œå¹¶æŒ‡å®šHDFSçš„åœ°å€
configuration.set("fs.defaultFS","hdfs://192.168.1.200:8020");
// åˆ›å»ºä¸€ä¸ªJobå¯¹è±¡
Job job = Job.getInstance(configuration);
// è®¾ç½®Jobçš„Mapperç±»
job.setMapperClass(WordCountMapper.class);
// è®¾ç½®Jobçš„Reducerç±»
job.setReducerClass(WordCountReducer.class);
// è®¾ç½®Mapperè¾“å‡ºçš„Keyå’ŒValueç±»å‹
job.setMapOutputKeyClass(Text.class);
job.setMapOutputValueClass(IntWritable.class);
// è®¾ç½®Reducerè¾“å‡ºçš„Keyå’ŒValueç±»å‹
job.setOutputKeyClass(Text.class);
job.setOutputValueClass(IntWritable.class);
// è·å–FileSystemå¯¹è±¡
FileSystem fs=FileSystem.get(new URI("hdfs://192.168.1.200:8020"),configuration,"hadoop");
// è®¾ç½®è¾“å‡ºè·¯å¾„
Path output=new Path("/map/output");
// å¦‚æœè¾“å‡ºè·¯å¾„å·²å­˜åœ¨ï¼Œåˆ™åˆ é™¤å®ƒ
if(fs.exists(output)){
    fs.delete(output,true);
}
// è®¾ç½®ä½œä¸šçš„è¾“å…¥è·¯å¾„
FileInputFormat.setInputPaths(job,new Path("/map/input"));
// è®¾ç½®ä½œä¸šçš„è¾“å‡ºè·¯å¾„
FileOutputFormat.setOutputPath(job,new Path("/map/output"));
// æäº¤ä½œä¸šå¹¶ç­‰å¾…ä½œä¸šå®Œæˆ
boolean result=job.waitForCompletion(true);
// æ ¹æ®ä½œä¸šæ‰§è¡Œç»“æœé€€å‡ºç¨‹åºï¼ŒæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1
System.exit( result ? 0:-1);
```
> è¯¦ç»†è§ï¼šHadoopåŸºç¡€-07-MapReduceæ¦‚è¿°
> [https://blog.csdn.net/jankin6/article/details/109060857](https://blog.csdn.net/jankin6/article/details/109060857)

### 2.4 å…¶ä»–


**2.4.1 Master Data Structures**
> æè¿°äº† Master èŠ‚ç‚¹åœ¨ MapReduce æ¡†æ¶ä¸­ç»´æŠ¤çš„æ•°æ®ç»“æ„ã€‚
> 
1. **ä»»åŠ¡çŠ¶æ€ä¿¡æ¯**ï¼š`Master`èŠ‚ç‚¹è®°å½•æ¯ä¸ª`Map`å’Œ`Reduce`ä»»åŠ¡çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å®ƒä»¬æ˜¯å¦å¤„äºç©ºé—²ã€è¿›è¡Œä¸­æˆ–å·²å®Œæˆã€‚

2. **å·¥ä½œèŠ‚ç‚¹ä¿¡æ¯**ï¼š`Master`èŠ‚ç‚¹è·Ÿè¸ªæ¯ä¸ª`Worker`èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨å®ƒä»¬ç©ºé—²æ—¶åˆ†é…ä»»åŠ¡ã€‚

3. **ä¸­é—´æ•°æ®ä½ç½®**ï¼šèµ·åˆ°äº†ä¸€ä¸ªç®¡é“çš„ä½œç”¨ï¼Œå¯¹äºæ¯ä¸ªå®Œæˆçš„`Map`ä»»åŠ¡ï¼Œ`Master`èŠ‚ç‚¹å­˜å‚¨äº†ä¸­é—´æ•°æ®çš„ä½ç½®å’Œå¤§å°ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºåç»­çš„`Reduce`ä»»åŠ¡æ˜¯å¿…è¦çš„ã€‚

4. **ä»»åŠ¡è°ƒåº¦ä¿¡æ¯**ï¼š`Master`èŠ‚ç‚¹è´Ÿè´£ä»»åŠ¡è°ƒåº¦ï¼Œç¡®ä¿ä»»åŠ¡åœ¨é›†ç¾¤ä¸­çš„æœºå™¨ä¸Šå¾—åˆ°æœ‰æ•ˆåˆ†é…ã€‚

5. **å®¹é”™æœºåˆ¶**ï¼š`Master`èŠ‚ç‚¹å¤„ç†èŠ‚ç‚¹æ•…éšœï¼Œç¡®ä¿ä»»åŠ¡åœ¨å¤±è´¥æ—¶èƒ½å¤Ÿé‡æ–°è°ƒåº¦ã€‚

è¿™äº›æ•°æ®ç»“æ„ä½¿å¾—`Master`èŠ‚ç‚¹èƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†å’Œåè°ƒMapReduceä½œä¸šçš„æ‰§è¡Œã€‚




**2.4.2 Fault Tolerance**
> æè¿°äº†MapReduceæ¡†æ¶å¦‚ä½•å¤„ç†æ•…éšœï¼Œä»¥ç¡®ä¿æ•°æ®å¤„ç†çš„é«˜å¯ç”¨æ€§å’Œå®¹é”™æ€§ã€‚
1. **WorkerèŠ‚ç‚¹æ•…éšœ**ï¼š
   - `Master`èŠ‚ç‚¹å®šæœŸå‘æ‰€æœ‰`Worker`èŠ‚ç‚¹å‘é€å¿ƒè·³ä¿¡å·ï¼Œä»¥æ£€æµ‹å®ƒä»¬çš„çŠ¶æ€ã€‚
   - å¦‚æœæŸä¸ª`Worker`èŠ‚ç‚¹åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰å“åº”ï¼Œ`Master`èŠ‚ç‚¹ä¼šå°†å…¶æ ‡è®°ä¸ºå¤±è´¥ã€‚
   - å¤±è´¥çš„`Worker`èŠ‚ç‚¹ä¸Šå·²å®Œæˆçš„`Map`ä»»åŠ¡éœ€è¦é‡æ–°æ‰§è¡Œï¼Œå› ä¸ºå®ƒä»¬çš„è¾“å‡ºå¯èƒ½å­˜å‚¨åœ¨å¤±è´¥èŠ‚ç‚¹çš„æœ¬åœ°ç£ç›˜ä¸Šï¼Œè€Œæ— æ³•è®¿é—®ã€‚
   - å¤±è´¥çš„`Worker`èŠ‚ç‚¹ä¸Šæ­£åœ¨è¿›è¡Œçš„`Map`æˆ–`Reduce`ä»»åŠ¡ä¼šè¢«é‡æ–°è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚

2. **`Master`èŠ‚ç‚¹æ•…éšœ**ï¼š
   - `Master`èŠ‚ç‚¹ä¼šå®šæœŸä¿å­˜å…¶æ•°æ®ç»“æ„çš„æ£€æŸ¥ç‚¹ï¼ˆcheckpointsï¼‰ï¼Œä»¥ä¾¿åœ¨`Master`èŠ‚ç‚¹å¤±è´¥æ—¶å¯ä»¥ä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹æ¢å¤ã€‚
   - ç”±äº`Master`èŠ‚ç‚¹é€šå¸¸æ˜¯å•ç‚¹ï¼Œå®ƒçš„å¤±è´¥å¯èƒ½ä¼šå½±å“æ•´ä¸ªä½œä¸šçš„æ‰§è¡Œã€‚å½“å‰çš„å®ç°ä¸­ï¼Œå¦‚æœ`Master`èŠ‚ç‚¹å¤±è´¥ï¼ŒMapReduceä½œä¸šå°†è¢«ä¸­æ­¢ã€‚

3. **æ•…éšœæƒ…å†µä¸‹çš„è¯­ä¹‰**ï¼š
   - å½“ç”¨æˆ·æä¾›çš„`Map`å’Œ`Reduce`æ“ä½œæ˜¯ç¡®å®šæ€§çš„ï¼Œå³å¯¹äºç»™å®šçš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºæ—¶ï¼ŒMapReduceçš„åˆ†å¸ƒå¼å®ç°å°†äº§ç”Ÿä¸æ— æ•…éšœé¡ºåºæ‰§è¡Œç›¸åŒçš„ç»“æœã€‚
   - ä¸ºäº†å®ç°è¿™ä¸€å±æ€§ï¼ŒMapReduceä¾èµ–äºåŸå­æäº¤ä»»åŠ¡è¾“å‡ºã€‚æ¯ä¸ªä»»åŠ¡çš„è¾“å‡ºè¢«å†™å…¥ç§æœ‰çš„ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œä»»åŠ¡å®Œæˆæ—¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«åŸå­åœ°é‡å‘½åæˆ–ç§»åŠ¨åˆ°æœ€ç»ˆä½ç½®ã€‚

4. **æ•°æ®å®Œæ•´æ€§**ï¼š
   - å³ä½¿åœ¨å‡ºç°æ•…éšœçš„æƒ…å†µä¸‹ï¼ŒMapReduceä¹Ÿç¡®ä¿æ•°æ®å¤„ç†çš„åŸå­æ€§å’Œä¸€è‡´æ€§ï¼Œä»è€Œä¿è¯äº†æ•°æ®å¤„ç†ç»“æœçš„æ­£ç¡®æ€§ã€‚

**2.4.3 Refinements**

> æè¿°äº†å¯¹åŸºæœ¬MapReduceæ¨¡å‹çš„ä¸€äº›æ‰©å±•å’Œæ”¹è¿›ï¼Œä»¥æé«˜å…¶çµæ´»æ€§å’Œå®ç”¨æ€§ã€‚

1. **åˆ†åŒºå‡½æ•°ï¼ˆPartitioning Functionï¼‰**ï¼š
   - ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸€ä¸ªåˆ†åŒºå‡½æ•°æ¥å†³å®šå¦‚ä½•å°†ä¸­é—´é”®åˆ†é…åˆ°ä¸åŒçš„Reducerä¸Šã€‚é»˜è®¤ä½¿ç”¨å“ˆå¸Œå‡½æ•°ï¼Œä½†ä¹Ÿå¯ä»¥æ ¹æ®ç‰¹å®šéœ€æ±‚å®šåˆ¶åˆ†åŒºé€»è¾‘ã€‚

2. **æ’åºä¿è¯ï¼ˆOrdering Guaranteesï¼‰**ï¼š
   - MapReduceä¿è¯äº†åœ¨åŒä¸€ä¸ªåˆ†åŒºå†…çš„é”®/å€¼å¯¹æ˜¯æŒ‰ç…§é”®çš„é¡ºåºæ’åºçš„ã€‚è¿™æœ‰åŠ©äºç”Ÿæˆæœ‰åºçš„è¾“å‡ºæ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯å½“è¾“å‡ºæ ¼å¼éœ€è¦æ”¯æŒé«˜æ•ˆçš„éšæœºè®¿é—®æŸ¥æ‰¾æ—¶ã€‚

3. **ç»„åˆå™¨å‡½æ•°ï¼ˆCombiner Functionï¼‰**ï¼š
   - ä¸ºäº†å‡å°‘ç½‘ç»œä¼ è¾“é‡ï¼Œç”¨æˆ·å¯ä»¥å®šä¹‰ä¸€ä¸ªCombinerå‡½æ•°åœ¨Mapä»»åŠ¡å®Œæˆåè¿›è¡Œå±€éƒ¨èšåˆã€‚è¿™é€šå¸¸ä¸Reducerå‡½æ•°ä½¿ç”¨ç›¸åŒçš„ä»£ç ï¼Œä½†è¾“å‡ºåˆ°ä¸­é—´æ–‡ä»¶è€Œä¸æ˜¯æœ€ç»ˆè¾“å‡ºã€‚

4. **è¾“å…¥å’Œè¾“å‡ºç±»å‹ï¼ˆInput and Output Typesï¼‰**ï¼š
   - MapReduceæ”¯æŒå¤šç§è¾“å…¥å’Œè¾“å‡ºæ ¼å¼ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å®ç°è‡ªå®šä¹‰çš„è¯»å†™å™¨ã€‚

5. **å‰¯ä½œç”¨ï¼ˆSide-effectsï¼‰**ï¼š
   - ç”¨æˆ·çš„Mapæˆ–Reduceå‡½æ•°å¯èƒ½ä¼šäº§ç”Ÿé¢å¤–çš„è¾“å‡ºæ–‡ä»¶ã€‚ç³»ç»Ÿä¾èµ–äºç”¨æˆ·ç¡®ä¿è¿™äº›å‰¯ä½œç”¨æ˜¯åŸå­çš„å’Œå¹‚ç­‰çš„ã€‚

6. **è·³è¿‡é”™è¯¯çš„è®°å½•ï¼ˆSkipping Bad Recordsï¼‰**ï¼š
   - å½“Mapæˆ–Reduceå‡½æ•°å› ä¸ºæŸäº›è¾“å…¥è®°å½•è€Œå´©æºƒæ—¶ï¼ŒMapReduceæä¾›äº†ä¸€ç§æ¨¡å¼æ¥æ£€æµ‹å¹¶è·³è¿‡è¿™äº›è®°å½•ï¼Œä»¥ä¾¿ä½œä¸šå¯ä»¥ç»§ç»­æ‰§è¡Œã€‚

7. **æœ¬åœ°æ‰§è¡Œï¼ˆLocal Executionï¼‰**ï¼š
   - ä¸ºäº†ä¾¿äºè°ƒè¯•å’Œæµ‹è¯•ï¼ŒMapReduceæä¾›äº†ä¸€ä¸ªå¯ä»¥åœ¨æœ¬åœ°æœºå™¨ä¸Šé¡ºåºæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡çš„æ¨¡å¼ã€‚

8. **çŠ¶æ€ä¿¡æ¯ï¼ˆStatus Informationï¼‰**ï¼š
   - `Master`èŠ‚ç‚¹æä¾›äº†çŠ¶æ€é¡µé¢ï¼Œæ˜¾ç¤ºä½œä¸šçš„è¿›åº¦å’Œèµ„æºä½¿ç”¨æƒ…å†µï¼Œå¸®åŠ©ç”¨æˆ·ç›‘æ§ä½œä¸šæ‰§è¡Œã€‚

9. **è®¡æ•°å™¨ï¼ˆCountersï¼‰**ï¼š
   - MapReduceæä¾›äº†ä¸€ä¸ªè®¡æ•°å™¨æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨Mapå’ŒReduceå‡½æ•°ä¸­åˆ›å»ºå’Œæ›´æ–°è®¡æ•°å™¨ï¼Œä»¥è·Ÿè¸ªç‰¹å®šäº‹ä»¶çš„å‘ç”Ÿæ¬¡æ•°ã€‚

## 3. æ€»ç»“


ç»¼ä¸Šæ‰€è¿°ï¼Œ`MapReduce`ç¼–ç¨‹æ¨¡å‹é€šè¿‡ç”¨æˆ·å®šä¹‰çš„`map`å’Œ`reduce`å‡½æ•°ï¼Œå°†å¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡è½¬åŒ–ä¸ºç›´è§‚çš„æ“ä½œï¼Œå¹¶è‡ªåŠ¨å¹¶è¡ŒåŒ–å¤„ç†ï¼Œæå¤§æé«˜äº†è®¡ç®—æ•ˆç‡ï¼Œå°¤å…¶åœ¨å¤§è§„æ¨¡é›†ç¾¤ç¯å¢ƒä¸­è¡¨ç°å‡ºè‰²ã€‚å…¶å†…ç½®çš„å®¹é”™æœºåˆ¶ç¡®ä¿äº†æ•°æ®å¤„ç†çš„å¯é æ€§ï¼Œä½¿å¾—`MapReduce`åœ¨æ–‡æœ¬åˆ†æã€æ•°æ®æŒ–æ˜å’Œç½‘é¡µç´¢å¼•ç­‰å¤šä¸ªé¢†åŸŸå¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚

æ›´é‡è¦çš„æ˜¯ï¼Œ`MapReduce`é™ä½äº†å¤§æ•°æ®æŠ€æœ¯çš„ä½¿ç”¨é—¨æ§›ï¼Œæ¨åŠ¨äº†æ•°æ®å¤„ç†æ•ˆç‡çš„æå‡ï¼Œå¹¶ä¿ƒè¿›äº†å¤§æ•°æ®ç”Ÿæ€ç³»ç»Ÿçš„å‘å±•ï¼Œå‚¬ç”Ÿäº†è¯¸å¦‚`Hadoop`ç­‰å…³é”®æŠ€æœ¯æ¡†æ¶ï¼Œä¸ºå¤§æ•°æ®çš„å‘å±•åšå‡ºäº†æ·±è¿œçš„è´¡çŒ®ã€‚

æœ€åï¼Œç”±äºç¯‡å¹…é™åˆ¶ï¼Œä¸€äº›æ•°æ®éªŒè¯çš„æ·±å…¥è®¨è®ºå¹¶æœªåœ¨æ­¤å±•å¼€ã€‚å¯¹äºæœ‰å…´è¶£è¿›ä¸€æ­¥æ¢ç´¢çš„è¯»è€…ï¼Œæˆ‘å»ºè®®ç²¾è¯»å…¨æ–‡ä»¥è·å¾—æ›´å…¨é¢çš„äº†è§£ã€‚


è·å–åŸæ–‡

 - GItHubï¼š[https://github.com/hiszm/BigDataWeekly/tree/main/èµ„æ–™](https://github.com/hiszm/BigDataWeekly/tree/main/%E8%B5%84%E6%96%99) 
 - å…¬ä¼—å·å›å¤ï¼š003






å¦‚æœä½ æƒ³å‚ä¸è®¨è®ºï¼Œè¯· ç‚¹å‡»è¿™é‡Œ[ğŸ‘‰https://github.com/hiszm/BigDataWeekly](https://github.com/hiszm/BigDataWeekly)ï¼Œæ¯å‘¨éƒ½æœ‰æ–°çš„ä¸»é¢˜ï¼Œå‘¨æœ«æˆ–å‘¨ä¸€å‘å¸ƒã€‚

**å¤§æ•°æ®ç²¾è¯»ï¼Œæ¢ç´¢çŸ¥è¯†çš„æ·±åº¦ã€‚**

> å…³æ³¨ **å¤§æ•°æ®ç²¾è¯»å‘¨åˆŠ** å¾®ä¿¡å…¬ä¼—å·
> ![image](https://github.com/user-attachments/assets/70e0f422-359d-4258-a3f7-30e2d3ebbd4b)





ç‰ˆæƒå£°æ˜ï¼šè‡ªç”±è½¬è½½-éå•†ç”¨-éè¡ç”Ÿ-ä¿æŒç½²åï¼ˆ[åˆ›æ„å…±äº« 3.0 è®¸å¯è¯](https://creativecommons.org/licenses/by-nc-nd/3.0/deed.en)ï¼‰
